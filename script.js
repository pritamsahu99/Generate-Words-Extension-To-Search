document.addEventListener("DOMContentLoaded", function () {
  const randomWordElement = document.getElementById("random-word");
  let usedWords = [];
  let currentTabId;

  randomWordElement.addEventListener("click", function () {
    const numberOfSearches = prompt("Enter the number of searches:");
    if (numberOfSearches && !isNaN(numberOfSearches)) {
      performAutomaticSearches(parseInt(numberOfSearches, 10));
    }
  });

  function performAutomaticSearches(numberOfSearches) {
    chrome.tabs.query({ active: true, currentWindow: true }, function (tabs) {
      if (tabs.length > 0) {
        currentTabId = tabs[0].id;
        recursiveSearch(numberOfSearches);
      }
    });
  }

  function recursiveSearch(remainingSearches) {
    if (remainingSearches > 0) {
      generateRandomWord(function (randomWord) {
        if (randomWord) {
          usedWords.push(randomWord);
          searchGoogle(randomWord, function () {
            recursiveSearch(remainingSearches - 1);
          });
        } else {
          usedWords = [];
          alert("All words have been used. Resetting the list.");
        }
      });
    }
  }

  function generateRandomWord(callback) {
    const meaningfulCombinations = [
      "abreact",
      "abreacted",
      "abreacting",
      "abreaction",
      "abreactions",
      "abreacts",
      "abreast",
      "abri",
      "abridge",
      "abridged",
      "abridgement",
      "abridgements",
      "abridger",
      "abridgers",
      "abridges",
      "abridging",
      "abridgment",
      "abridgments",
      "abris",
      "abroach",
      "abroad",
      "abrogable",
      "abrogate",
      "abrogated",
      "abrogates",
      "abrogating",
      "abrogation",
      "abrogations",
      "abrogator",
      "abrogators",
      "abrosia",
      "abrosias",
      "abrupt",
      "abrupter",
      "abruptest",
      "abruption",
      "abruptions",
      "abruptly",
      "abruptness",
      "abruptnesses",
      "abs",
      "abscess",
      "abscessed",
      "abscesses",
      "abscessing",
      "abscise",
      "abscised",
      "abscises",
      "abscisin",
      "abscising",
      "abscisins",
      "abscissa",
      "abscissae",
      "abscissas",
      "abscission",
      "abscissions",
      "abscond",
      "absconded",
      "absconder",
      "absconders",
      "absconding",
      "absconds",
      "abseil",
      "abseiled",
      "abseiling",
      "abseils",
      "absence",
      "absences",
      "absent",
      "absented",
      "absentee",
      "absenteeism",
      "absenteeisms",
      "absentees",
      "absenter",
      "absenters",
      "absenting",
      "absently",
      "absentminded",
      "absentmindedly",
      "absents",
      "absinth",
      "absinthe",
      "absinthes",
      "absinths",
      "absolute",
      "absolutely",
      "absoluteness",
      "absolutenesses",
      "absoluter",
      "absolutes",
      "absolutest",
      "absolution",
      "absolutions",
      "absolutism",
      "absolutisms",
      "absolutist",
      "absolutistic",
      "absolutists",
      "absolutive",
      "absolutize",
      "absolutized",
      "absolutizes",
      "absolutizing",
      "absolve",
      "absolved",
      "absolvent",
      "absolvents",
      "absolver",
      "absolvers",
      "absolves",
      "absolving",
      "absonant",
      "absorb",
      "absorbabilities",
      "absorbability",
      "absorbable",
      "absorbance",
      "absorbances",
      "absorbancies",
      "absorbancy",
      "absorbant",
      "absorbants",
      "absorbed",
      "absorbencies",
      "absorbency",
      "absorbent",
      "absorbents",
      "absorber",
      "absorbers",
      "absorbing",
      "absorbingly",
      "absorbs",
      "absorptance",
      "absorptances",
      "absorption",
      "absorptions",
      "absorptive",
      "absorptivities",
      "absorptivity",
      "abstain",
      "abstained",
      "abstainer",
      "abstainers",
      "abstaining",
      "abstains",
      "abstemious",
      "abstemiously",
      "abstemiousness",
      "abstention",
      "abstentions",
      "abstentious",
      "absterge",
      "absterged",
      "absterges",
      "absterging",
      "abstinence",
      "abstinences",
      "abstinent",
      "abstinently",
      "abstract",
      "abstractable",
      "abstracted",
      "abstractedly",
      "abstractedness",
      "abstracter",
      "abstracters",
      "abstractest",
      "abstracting",
      "abstraction",
      "abstractional",
      "abstractionism",
      "abstractionisms",
      "abstractionist",
      "abstractionists",
      "abstractions",
      "abstractive",
      "abstractly",
      "abstractness",
      "abstractnesses",
      "abstractor",
      "abstractors",
      "abstracts",
      "abstrict",
      "abstricted",
      "abstricting",
      "abstricts",
      "abstruse",
      "abstrusely",
      "abstruseness",
      "abstrusenesses",
      "abstruser",
      "abstrusest",
      "abstrusities",
      "abstrusity",
      "absurd",
      "absurder",
      "absurdest",
      "absurdism",
      "absurdisms",
      "absurdist",
      "absurdists",
      "absurdities",
      "absurdity",
      "absurdly",
      "absurdness",
      "absurdnesses",
      "absurds",
      "abubble",
      "abuilding",
      "abulia",
      "abulias",
      "abulic",
      "abundance",
      "abundances",
      "abundant",
      "abundantly",
      "abusable",
      "abuse",
      "abused",
      "abuser",
      "abusers",
      "abuses",
      "abusing",
      "abusive",
      "abusively",
      "abusiveness",
      "abusivenesses",
      "abut",
      "abutilon",
      "abutilons",
      "abutment",
      "abutments",
      "abuts",
      "abuttal",
      "abuttals",
      "abutted",
      "abutter",
      "abutters",
      "abutting",
      "abuzz",
      "abvolt",
      "abvolts",
      "abwatt",
      "abwatts",
      "aby",
      "abye",
      "abyes",
      "abying",
      "abys",
      "abysm",
      "abysmal",
      "abysmally",
      "abysms",
      "abyss",
      "abyssal",
      "abysses",
      "acacia",
      "acacias",
      "academe",
      "academes",
      "academia",
      "academias",
      "academic",
      "academical",
      "academically",
      "academician",
      "academicians",
      "academicism",
      "academicisms",
      "academics",
      "academies",
      "academism",
      "academisms",
      "academy",
      "acajou",
      "acajous",
      "acaleph",
      "acalephae",
      "acalephe",
      "acalephes",
      "acalephs",
      "acantha",
      "acanthae",
      "acanthi",
      "acanthine",
      "acanthocephalan",
      "acanthoid",
      "acanthous",
      "acanthus",
      "acanthuses",
      "acapnia",
      "acapnias",
      "acarbose",
      "acarboses",
      "acari",
      "acariases",
      "acariasis",
      "acaricidal",
      "acaricide",
      "acaricides",
      "acarid",
      "acaridan",
      "acaridans",
      "acarids",
      "acarine",
      "acarines",
      "acaroid",
      "acarologies",
      "acarology",
      "acarpous",
      "acarus",
      "acatalectic",
      "acatalectics",
      "acaudal",
      "acaudate",
      "acaulescent",
      "acauline",
      "acaulose",
      "acaulous",
      "accede",
      "acceded",
      "accedence",
      "accedences",
      "acceder",
      "acceders",
      "accedes",
      "acceding",
      "accelerando",
      "accelerandos",
      "accelerant",
      "accelerants",
      "accelerate",
      "accelerated",
      "accelerates",
      "accelerating",
      "acceleratingly",
      "acceleration",
      "accelerations",
      "accelerative",
      "accelerator",
      "accelerators",
      "accelerometer",
      "accelerometers",
      "accent",
      "accented",
      "accenting",
      "accentless",
      "accentor",
      "accentors",
      "accents",
      "accentual",
      "accentually",
      "accentuate",
      "accentuated",
      "accentuates",
      "accentuating",
      "accentuation",
      "accentuations",
      "accept",
      "acceptabilities",
      "acceptability",
      "acceptable",
      "acceptableness",
      "acceptably",
      "acceptance",
      "acceptances",
      "acceptant",
      "acceptation",
      "acceptations",
      "accepted",
      "acceptedly",
      "acceptee",
      "acceptees",
      "accepter",
      "accepters",
      "accepting",
      "acceptingly",
      "acceptingness",
      "acceptingnesses",
      "acceptive",
      "acceptor",
      "acceptors",
      "accepts",
      "access",
      "accessaries",
      "accessary",
      "accessed",
      "accesses",
      "accessibilities",
      "accessibility",
      "accessible",
      "accessibleness",
      "accessibly",
      "accessing",
      "accession",
      "accessional",
      "accessioned",
      "accessioning",
      "accessions",
      "accessorial",
      "accessories",
      "accessorise",
      "accessorised",
      "accessorises",
      "accessorising",
      "accessorize",
      "accessorized",
      "accessorizes",
      "accessorizing",
      "accessory",
      "acciaccatura",
      "acciaccaturas",
      "accidence",
      "accidences",
      "accident",
      "accidental",
      "accidentally",
      "accidentalness",
      "accidentals",
      "accidently",
      "accidents",
      "accidia",
      "accidias",
      "accidie",
      "accidies",
      "accipiter",
      "accipiters",
      "accipitrine",
      "accipitrines",
      "acclaim",
      "acclaimed",
      "acclaimer",
      "acclaimers",
      "acclaiming",
      "acclaims",
      "acclamation",
      "acclamations",
      "acclimate",
      "acclimated",
      "acclimates",
      "acclimating",
      "acclimation",
      "acclimations",
      "acclimatise",
      "acclimatised",
      "acclimatises",
      "acclimatising",
      "acclimatization",
      "acclimatize",
      "acclimatized",
      "acclimatizer",
      "acclimatizers",
      "acclimatizes",
      "acclimatizing",
      "acclivities",
      "acclivity",
      "acclivous",
      "accolade",
      "accoladed",
      "accolades",
      "accolading",
      "accommodate",
      "accommodated",
      "accommodates",
      "accommodating",
      "accommodatingly",
      "accommodation",
      "accommodational",
      "accommodations",
      "accommodative",
      "accommodator",
      "accommodators",
      "accompanied",
      "accompanies",
      "accompaniment",
      "accompaniments",
      "accompanist",
      "accompanists",
      "accompany",
      "accompanying",
      "accomplice",
      "accomplices",
      "accomplish",
      "accomplishable",
      "accomplished",
      "accomplisher",
      "accomplishers",
      "accomplishes",
      "accomplishing",
      "accomplishment",
      "accomplishments",
      "accord",
      "accordance",
      "accordances",
      "accordant",
      "accordantly",
      "accorded",
      "accorder",
      "accorders",
      "according",
      "accordingly",
      "accordion",
      "accordionist",
      "accordionists",
      "accordions",
      "accords",
      "accost",
      "accosted",
      "accosting",
      "accosts",
      "accouchement",
      "accouchements",
      "accoucheur",
      "accoucheurs",
      "account",
      "accountability",
      "accountable",
      "accountableness",
      "accountably",
      "accountancies",
      "accountancy",
      "accountant",
      "accountants",
      "accountantship",
      "accountantships",
      "accounted",
      "accounting",
      "accountings",
      "accounts",
      "accouter",
      "accoutered",
      "accoutering",
      "accouterment",
      "accouterments",
      "accouters",
      "accoutre",
      "accoutred",
      "accoutrement",
      "accoutrements",
      "accoutres",
      "accoutring",
      "accredit",
      "accreditable",
      "accreditation",
      "accreditations",
      "accredited",
      "accrediting",
      "accredits",
      "accrete",
      "accreted",
      "accretes",
      "accreting",
      "accretion",
      "accretionary",
      "accretions",
      "accretive",
      "accruable",
      "accrual",
      "accruals",
      "accrue",
      "accrued",
      "accruement",
      "accruements",
      "accrues",
      "accruing",
      "acculturate",
      "acculturated",
      "acculturates",
      "acculturating",
      "acculturation",
      "acculturational",
      "acculturations",
      "acculturative",
      "accumbent",
      "accumulate",
      "accumulated",
      "accumulates",
      "accumulating",
      "accumulation",
      "accumulations",
      "accumulative",
      "accumulatively",
      "accumulator",
      "accumulators",
      "accuracies",
      "accuracy",
      "accurate",
      "accurately",
      "accurateness",
      "accuratenesses",
      "accursed",
      "accursedly",
      "accursedness",
      "accursednesses",
      "accurst",
      "accusable",
      "accusably",
      "accusal",
      "accusals",
      "accusant",
      "accusants",
      "accusation",
      "accusations",
      "accusative",
      "accusatives",
      "accusatory",
      "accuse",
      "accused",
      "accuser",
      "accusers",
      "accuses",
      "accusing",
      "accusingly",
      "accustom",
      "accustomation",
      "accustomations",
      "accustomed",
      "accustomedness",
      "accustoming",
      "accustoms",
      "ace",
      "aced",
      "acedia",
      "acedias",
      "aceldama",
      "aceldamas",
      "acellular",
      "acentric",
      "acephalic",
      "acephalous",
      "acequia",
      "acequias",
      "acerate",
      "acerated",
      "acerb",
      "acerbate",
      "sky",
      "down",
      "science",
      "random",
      "coding",
      "javascript",
      "gpt",
      "extension",
      "meaningful",
    ];
    const availableWords = meaningfulCombinations.filter(
      (word) => !usedWords.includes(word)
    );

    if (availableWords.length === 0) {
      return null;
    }

    const randomIndex = Math.floor(Math.random() * availableWords.length);
    callback(availableWords[randomIndex]);
  }

  function searchGoogle(query, callback) {
    chrome.tabs.update(
      currentTabId,
      { url: `https://www.bing.com/search?q=${encodeURIComponent(query)}` },
      function () {
        setTimeout(callback, 2000);
      }
    );
  }
});
